<!doctype html>
<html lang="en">
<head>
    <title>Handwritten Digit Recognizer</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css">
</head>
<body onload="InitThis();">
<div class="container">
    <nav id="mynavbar" class="navbar sticky-top navbar-light bg-light">
        <a class="navbar-brand" href="#">Handwritten digit recognizer</a>
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a class="nav-link" href="#">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#archtecture">Architecture</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#training_algorithm">Algorithms</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#trainingset">Training set</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#github">GitHub</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#author">Author</a>
            </li>
        </ul>
    </nav>
    <div align="center">
        <div class="alert alert-primary" role="alert">BETA: There are known issues with some digits, work is still in progress...</div>
        <h5>Please write any digit from 0 to 9 into the box</h5>
        <canvas id="myCanvas" width="200" height="200" style="border:2px solid black"></canvas>
        <br>
        <small>Please write your digits in American English style, as the training set is originated from the US.<br>
            Have a look at <a href="trainingset.png">this subset of training data</a> for examples
        </small>
        <br>
        <table class="table">
            <thead>
                <tr>
                    <th>Prediction</th>
                    <th>Confidence</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="prediction" align="center">-</td>
                    <td id="confidence" align="center">-</td>
                </tr>
            </tbody>
        </table>
        <div style="display: none">
            Line width :
            <select id="selWidth">
                <option value="9">9</option>
                <option value="11">11</option>
                <option value="13">13</option>
                <option value="15">15</option>
                <option value="18" selected="selected">18</option>
                <option value="21">21</option>
                <option value="23">23</option>
                <option value="27">27</option>
            </select>
            Color :
            <select id="selColor">
                <option value="black">black</option>
                <option value="blue" selected="selected">blue</option>
                <option value="red">red</option>
                <option value="green">green</option>
                <option value="yellow">yellow</option>
                <option value="gray">gray</option>
            </select>
        </div>

        <br>
        <button class="btn btn-primary" onclick="javascript:send();return false;">Recognize</button>
        <button class="btn btn-secondary" onclick="javascript:clearArea();return false;">Clear Area</button>

        <table id="weightTable" border="1">
            <caption>Weights</caption>
            <thead>
            <tr>
                <th>Output Unit</th>
                <th>Weight</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>0</td>
                <td id="w0"></td>
            </tr>
            <tr>
                <td>1</td>
                <td id="w1"></td>
            </tr>
            <tr>
                <td>2</td>
                <td id="w2"></td>
            </tr>
            <tr>
                <td>3</td>
                <td id="w3"></td>
            </tr>
            <tr>
                <td>4</td>
                <td id="w4"></td>
            </tr>
            <tr>
                <td>5</td>
                <td id="w5"></td>
            </tr>
            <tr>
                <td>6</td>
                <td id="w6"></td>
            </tr>
            <tr>
                <td>7</td>
                <td id="w7"></td>
            </tr>
            <tr>
                <td>8</td>
                <td id="w8"></td>
            </tr>
            <tr>
                <td>9</td>
                <td id="w9"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <h4 id="archtecture">Architecture</h4>
    <p>The neural network has 3 layers: 1 input, 1 output and 1 hidden layer.
    The hidden layer contains 300 units, the input layer has units for each pixel and we have ten output units, one for each digit.
    <img src="Neural_network.png" class="img-fluid" alt="Neural network" align="center"><br>
    </p>
    <h4 id="training_algorithm">Training Algorithm</h4>
    <p>The training was performed by me using Octave programming language and the backpropagation algorithm.
    <p>The cost function is the generalization of logistic regression.
    The cost function includes regularization in order to keep the weights small and thus generalize the model more.
    <p>With backpropagation we are able to calculate the partial derivative of the cost function on every weight.
    When the optimalization algorithm is fed with both the cost function and its derivatives, it can minimize the cost
    function using gradient descent.
    <p>Both the backpropagation and the cost function is my implementation in Octave.
    The optimalization algorithm (fmincg) is based upon Andrew Ng's Coursera class: Machine Learning.
    <h4 id="prediction_algorithm">Prediction Algorithm</h4>
    The prediction algorithm is a Java service hosted in Google Cloud Platform. After having the weights for
        each unit, the prediction is an implementation of forward propagation which is basically
        only matrix multiplication and the sigmoid function applied. I did not use any ML library for this,
        the Apache Commons Math was enough.
    </p>
    <h4 id="trainingset">Training set</h4>
    <p>The neural network was trained using the <a href="http://yann.lecun.com/exdb/mnist/">MNIST database</a> using 60000 examples.
    The training set is <a href="mnist-all.png">visualised here</a>
    </p>
    <h4 id="github">GitHub</h4>
    <p>Source code available at
        <a href="https://github.com/kavai77/handwriting">https://github.com/kavai77/handwriting</a>
    </p>
    <h4 id="author">Author</h4>
    <p>Csaba Kavai
    <a href="https://www.linkedin.com/in/csaba-kavai/">Linked profile</a>
    </p>

</div>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
<script type="text/javascript" src="JsCode.js"></script>
</body>
</html>